## å¯†æ–‡æ¿

#è´ªå¿ƒ #æ„é€  

è¿™é¢˜çœ‹èµ·æ¥å°±å¾ˆåƒè´ªå¿ƒæ„é€ ç­”æ¡ˆã€‚

é¦–å…ˆæˆ‘ä»¬æŠŠå¯ä»¥åŒ¹é…çš„å·¦å³æ‹¬å·éƒ½å…ˆåŒ¹é…ä¸Šï¼Œå…·ä½“æ€è·¯æ˜¯ä»å·¦å¾€å³æšä¸¾ï¼Œå¯¹äºæ¯ä¸ªå³æ‹¬å·ï¼Œå¦‚æœå·¦è¾¹æœ‰è¿˜æ²¡æœ‰åŒ¹é…çš„å·¦æ‹¬å·ï¼Œé‚£ä¹ˆå°±åŒ¹é…ä¸Šã€‚

æ¥ä¸‹æ¥è€ƒè™‘ä¸€ä¸ªé—®å·å’Œä¸€ä¸ªæ‹¬å·åŒ¹é…ã€‚ä¸€ç§æ˜¯é—®å·å’Œå³æ‹¬å·åŒ¹é…ã€‚ç”±äºå’Œä¸Šé¢è¿›è¡Œåˆå§‹åŒ¹é…ä¸€æ ·éƒ½éœ€è¦æšä¸¾å³æ‹¬å·ï¼Œæ‰€ä»¥å¯ä»¥ä¸€èµ·å¤„ç†ã€‚ç„¶åæ˜¯å·¦æ‹¬å·å’Œé—®å·åŒ¹é…ï¼Œæ­£ç€æˆ–åç€æšä¸¾å‡å¯ï¼Œä½†æ˜¯æ­£ç€æšä¸¾å¿…é¡»é€‰å¤§äºå½“å‰ä¸‹æ ‡çš„æœ€å°ä¸‹æ ‡çš„é—®å·ï¼Œåç€åˆ™ä¸éœ€è¦ã€‚

ç”±äºæˆ‘ä»¬æœ‰äº›å·¦æ‹¬å·å·²ç»åœ¨ä¹‹å‰è·Ÿå³æ‹¬å·åŒ¹é…äº†ï¼Œè€Œè¿™é‡Œå’Œé—®å·åŒ¹é…å½“ç„¶æ˜¯è¶Šé å·¦è¶Šå¥½ã€‚æ‰€ä»¥æœ€å¼€å§‹æˆ‘ä»¬æ‰¾å’Œå³æ‹¬å·åŒ¹é…çš„å·¦æ‹¬å·éœ€è¦ä¼˜å…ˆé€‰ä¸‹æ ‡æ›´å¤§çš„ï¼ˆæ ˆå®ç°ï¼‰ï¼Œè¿™æ ·æ‰ä½¿å¾—åœ¨å¯ä»¥ç•™ä¸‹å·¦æ‹¬å·çš„æƒ…å†µä¸‹ï¼Œå·¦æ‹¬å·éƒ½å°½é‡é å·¦ï¼Œå¯ä»¥ä¸æ›´å¤šå³è¾¹çš„é—®å·åŒ¹é…ã€‚

æœ€åæ˜¯å‰©ä¸‹çš„é—®å·è‡ªå·±å’Œè‡ªå·±åŒ¹é…ã€‚æŒ‰ç…§ä¸‹æ ‡ä»å°åˆ°å¤§çš„é¡ºåºä¸€å·¦ä¸€å³å³å¯ã€‚

ç»´æŠ¤æ‰€æœ‰çš„é—®å·æˆ‘æ˜¯ç”¨äº† setã€‚å¯ä»¥å¿«é€Ÿæ‰¾å°äº/å¤§äºæŸä¸ªä¸‹æ ‡çš„é—®å·ï¼Œå¹¶ä¸”æ”¯æŒåˆ é™¤ã€‚æ—¶é—´å¤æ‚åº¦ $\mathcal O(n\log_2 n)$ã€‚

```cpp
#include <fstream>
#include <stack>
#include <set>

using namespace std;

const int kMaxN = 1e5 + 5;

ifstream cin("cipher.in");
ofstream cout("cipher.out");

int f[kMaxN], t, n;
set<int> s;
stack<int> q;
char a[kMaxN];

int main() {
  cin.tie(0)->sync_with_stdio(0);
  for (cin >> t; t; t--) {
    cin >> n >> a;
    for (int i = n; i >= 1; i--) {
      a[i] = a[i - 1];
    }
    fill(f + 1, f + n + 1, 0);
    for (; q.size(); q.pop()) { }
    s.clear();
    int ans = 0;
    for (int i = 1; i <= n; i++) {
      if (a[i] == '?') {
        s.insert(i);
      }
    }
    for (int i = 1; i <= n; i++) {
      if (a[i] == '(') {
        q.push(i);
      } else if (a[i] == ')') {
        if (q.size()) {
          f[q.top()] = f[i] = 1;
          q.pop();
          ans++;
          continue;
        }
        auto p = s.lower_bound(i);
        if (p != s.begin()) {
          p--;
          f[*p] = f[i] = 1;
          a[*p] = '(';
          s.erase(p);
          ans++;
        }
      }
    }
    for (int i = n; i >= 1; i--) {
      if (a[i] == '(' && !f[i]) {
        auto p = s.upper_bound(i);
        if (p != s.end()) {
          s.erase(p);
          a[*p] = ')';
          ans++;
        }
      }
    }
    bool b = 1;
    for (int i : s) {
      a[i] = b ? '(' : ')';
      ans += !b;
      b ^= 1;
    }
    cout << n - 2 * ans << '\n' << (a + 1) << '\n';
  }
  return 0;
}
```

## æ‹¬å·åºåˆ—

#çŠ¶å‹dp #äºŒåˆ† #å‰ç¼€å’Œ 

é¦–å…ˆçœ‹åˆ° $n\le 20$ï¼Œè¿™å¾ˆæœ‰å¯èƒ½æ˜¯çŠ¶å‹çš„é¢˜ç›®ã€‚ç„¶åå†çœ‹åˆ°æ‹¬å·åºåˆ—ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æ„å»ºä¸€ä¸ªå‰ç¼€å’Œæ•°ç»„ï¼Œå·¦æ‹¬å·å‡ä¸€å³æ‹¬å·åŠ ä¸€ï¼Œå¯¹äºä¸€æ®µå‰ç¼€å’Œéƒ½ä¸å°äº $0$ çš„å‰ç¼€ï¼Œæœ‰å¤šå°‘ä¸ª $0$ å°±ä»£è¡¨ç€æœ‰å¤šå°‘ä¸ªåˆæ³•æ‹¬å·ä¸²å‰ç¼€ã€‚

ç„¶åæˆ‘å°±è®¾è®¡å‡ºäº†çŠ¶æ€ï¼š$dp_{i,j}$ è¡¨ç¤ºè‹¥ $n$ ä¸ªä¸²çš„å·²é€‰çŠ¶æ€ä¸º $i$ï¼Œæœ€åçš„å‰ç¼€å€¼ä¸º $j$ æ‰€èƒ½è·å¾—çš„æœ€å¤§ç­”æ¡ˆã€‚å½“æ—¶æˆ‘è§‰å¾—è¿™ä¸ªçŠ¶æ€ä¼šç‚¸ï¼Œå› ä¸º $j$ çš„å–å€¼ç‰¹åˆ«å¤šï¼Œä½†æ˜¯å®é™…ä¸Š $j$ åªæœ‰ä¸€ç§å–å€¼ï¼Œå³ $i$ åŒ…å«çš„æ‰€æœ‰ $s_i$ çš„å‰ç¼€å’Œå€¼ç›¸åŠ çš„å’Œã€‚ä¸è¿‡æˆ‘èµ›æ—¶è¿˜æ˜¯å†™äº†ä¸ª `map` å°±æ˜¯äº†ã€‚

æšä¸¾å·²é€‰çŠ¶æ€ $i$ ä¹‹åï¼Œå†æšä¸¾æ–°çš„è¦é€‰çš„ $j$ã€‚å¦‚ä½•åˆ¤æ–­æ‹¼ä¸Š $j$ äº†ä¹‹åæ˜¯å¦å­˜åœ¨ä¸€æ®µå‰ç¼€å’Œå°äº $0$ å‘¢ï¼Ÿå¯ä»¥å¯¹æ¯ä¸ªä¸²çš„å‰ç¼€å’Œå€¼å†åšä¸€ä¸ªå‰ç¼€ $\min$ï¼Œè¿™æ ·å°±å¯ä»¥å¿«é€Ÿåˆ¤æ–­æ•´ä¸ªä¸²ã€‚å¦‚æœæ•´ä¸ªä¸²æ‹¼ä¸Šæ¥ä¸ä¼šå¯¼è‡´æœ‰å°äº $0$ çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è½¬ç§» dpã€‚

å¯¹äºæœ‰å°äº $0$ çš„ï¼Œæ‹¼å®Œè¿™ä¸€æ®µç»§ç»­æ‹¼ä»»ä½•ä¸œè¥¿éƒ½ä¸ä¼šæœ‰ä»»ä½•åŠ æˆäº†ã€‚æ‰€ä»¥æˆ‘ä»¬é€šè¿‡é‚£ä¸ªå‰ç¼€ $\min$ çš„æ•°ç»„åšäºŒåˆ†ï¼Œæ‰¾åˆ°æœ€å¤§çš„ $p$ ä½¿å¾—å‰ $p$ ä¸ªæ•°éƒ½ä¸ä¼šå¯¼è‡´å‰ç¼€å€¼å˜åˆ°è´Ÿæ•°ã€‚äºŒåˆ†å®Œæˆ‘ä»¬è¿˜éœ€è¦æ±‚ä¸€ä¸ªå‰ç¼€å½“ä¸­æœ‰å¤šå°‘ä¸ªæŒ‡å®šçš„æ•°ã€‚æ¯ä¸ªå­—ç¬¦ä¸²å¼€ $2\times|s_i|+1$ ä¸ª `vector` å­˜å‰ç¼€å€¼æ‰€å¯¹åº”çš„ä¸‹æ ‡ï¼ˆè¦åŠ åç§»é‡åº”å¯¹è´Ÿæ•°ï¼‰ï¼Œåœ¨ä¸‹æ ‡ `vector` ä¸ŠäºŒåˆ†å³å¯ã€‚

æ—¶é—´å¤æ‚åº¦ $\mathcal O\left(2^n\left(n+\sum\limits_{i=1}^n\log|s_i|\right)\right)$ã€‚å½“ç„¶æˆ‘çå†™äº† `map` å¸¸æ•°è¾ƒå¤§ã€‚

- [!] æ³¨æ„æŸ¥è¯¢ä¸€å®šè¦åˆ¤è¶Šç•Œï¼Œè¿™å°±æ˜¯æˆ‘åœ¨åˆæµ‹æ˜¯æŒ‚ $60$ åˆ†çš„åŸå› ã€‚
- [c] ä¸€ä¸ªæ‚²ä¼¤çš„æ•…äº‹æ˜¯ï¼Œç”±äºæˆ‘æŠŠ `<fstream>` çš„ `f` å†™æˆäº†å¤§å†™ `F` ç›´æ¥å¯¼è‡´æˆ‘è¿™é¢˜åœ¨ Linux ä¸Š CE ä¿çµã€‚**è­¦é’Ÿé•¿é¸£ğŸ””**

```cpp
#include <fstream>  // ä¸è¦å†™æˆ Fstream
#include <algorithm>
#include <vector>
#include <map>

using namespace std;

const int kMaxN = 21;

ifstream cin("seq.in");
ofstream cout("seq.out");

int n, ans;
string s[kMaxN];
vector<int> p[kMaxN], m[kMaxN];
vector<vector<int>> v[kMaxN];
map<int, int> dp[1 << kMaxN];

vector<int> &get(int i, int j) {
  static vector<int> empty;
  if (j + s[i].size() < 0 || j + s[i].size() >= v[i].size()) {  // è¶Šç•Œ
    return empty;
  }
  return v[i][j + s[i].size()];
}

int main() {
  cin.tie(0)->sync_with_stdio(0);
  cin >> n;
  for (int i = 1; i <= n; i++) {
    cin >> s[i];
    int pre = 0, mn = 1e9;
    p[i].reserve(s[i].size());
    m[i].reserve(s[i].size());
    v[i].resize(2 * s[i].size() + 1);
    for (int j = 0; j < s[i].size(); j++) {
      pre += (s[i][j] == '(' ? 1 : -1);
      mn = min(mn, pre);
      p[i].push_back(pre);
      m[i].push_back(mn);
      get(i, pre).push_back(j);
    }
  }
  dp[0][0] = 0;
  for (int i = 0; i < (1 << n); i++) {
    for (const auto &j : dp[i]) {
      for (int k = 1; k <= n; k++) {
        if (i & (1 << (k - 1))) {
          continue;
        }
        if (j.first + m[k].back() >= 0) {
          int &x = dp[i | (1 << (k - 1))][j.first + p[k].back()];
          int val = j.second + get(k, -j.first).size();
          x = max(x, val);
          ans = max(ans, val);
          continue;
        }
        int p = -1;
        for (int l = 0, r = s[k].size() - 1; l <= r; ) {
          int mid = (l + r) / 2;
          if (j.first + m[k][mid] >= 0) {
            p = mid;
            l = mid + 1;
          } else {
            r = mid - 1;
          }
        }
        if (p != -1) {
          auto x = get(k, -j.first);
          int val = upper_bound(x.begin(), x.end(), p) - x.begin();
          ans = max<int>(ans, j.second + val);
        }
      }
    }
  }
  cout << ans << '\n';
  return 0;
}
```

## æ³•å›½

#æš´åŠ› #æ•°å­¦ 

è®° $a=att,b=hp,A=Att,B=Hp$.

é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªå¼å­ $\sum\limits_{i=1}^k\left\lceil\cfrac{b_i}{A_q}\right\rceil a_i\ge B_q$ã€‚æˆ‘é ï¼Œæ€ä¹ˆè¿™ä¹ˆå¤æ‚ï¼Œè€Œä¸”éšç€ ${} q$ çš„å¢å¤§ï¼Œ$A_q$ ä¼šå¢å¤§ï¼Œè¿™ä¸ªåˆ†æ•°ä¼šå˜å°è¿™ä¹Ÿå¤ªéš¾ç»´æŠ¤äº†å§ï¼Ÿä½†æ˜¯ä»”ç»†æƒ³æƒ³ï¼Œåˆ†å­ $b_i$ æ˜¯å›ºå®šçš„ï¼Œåˆ†æ¯å•è°ƒé€’å¢ï¼Œè€Œä¸€ä¸ªæ•° $x$ é™¤ä»¥ä»»æ„æ­£æ•°ï¼ˆä¸Šæˆ–ä¸‹å–æ•´å‡å¯ï¼‰ï¼Œä¸åŒçš„ç­”æ¡ˆå®ƒçš„é‡çº§è²Œä¼¼æ˜¯ $\mathcal O\left(\sqrt x\right)$ çº§åˆ«çš„ï¼ˆå®æµ‹ ${} x=3\times 10^5 {}$ æ—¶å¤§çº¦æœ‰ $1000$ ä¸ªï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨åˆ†æ•° $\left\lceil\cfrac{b_i}{A_q}\right\rceil$ çš„å€¼å‘ç”Ÿå˜åŒ–æ˜¯é‡æ–°è®¡ç®—è´¡çŒ®å³å¯ã€‚è¿™æ ·å­æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $\mathcal O(n\sqrt V)$ çš„äº†ï¼Œå®Œå…¨å¯è¡Œã€‚

ç°åœ¨æˆ‘ä»¬è€ƒè™‘å½“ $A_q$ å¢å¤§åˆ°å¤šå°‘çš„æ—¶å€™åˆ†æ•°å€¼ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå³è§£å…³äº $x$ çš„æ–¹ç¨‹ $\left\lceil\cfrac{a}{x}\right\rceil<b$ã€‚æ ¹æ®èµ¤çŸ³çš„æ¨å¯¼ï¼Œå¯ä»¥å¾—åˆ° ${} x\ge\left\lceil\cfrac{a}{b-1}\right\rceil {}$ï¼Œè¿™é‡Œ $a=b_i,b=\left\lceil\cfrac{b_i}{A_q}\right\rceil$ã€‚æ‰€ä»¥å½“åˆ°åé¢æœ€å°çš„æ»¡è¶³ $A_q\ge x$ çš„åœ°æ–¹ï¼Œåˆ†æ•°å€¼æ‰ä¼šæ”¹å˜ã€‚

ç”±äºæœ¬é¢˜å€¼åŸŸåªæœ‰ $3\times 10^5$ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŠŠ $x$ å½“ä¸‹æ ‡ï¼Œå°† $i$ çš„å€¼å­˜åˆ° `vector` é‡Œé¢ã€‚å†ç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆ $k$ ç”¨æ¥éå†é‡æ„ï¼Œæ¯æ¬¡æŠŠ $k$ ç§»åŠ¨åˆ° $\le A_q$ çš„æ‰€æœ‰å€¼ä¸Šï¼Œä» `vector` é‡Œé¢å–å‡ºä¸‹æ ‡é‡æ–°è®¡ç®—è´¡çŒ®ï¼Œè®¡ç®—å®Œä¹‹åå†ç®—å‡ºä¸‹ä¸€æ¬¡é‡ç®—è´¡çŒ®éœ€è¦çš„ $A_q$ å€¼ã€‚ç”±äºæ¯ä¸ªå…ƒç´ é‡ç®—è´¡çŒ®çš„æ—¶é—´å¤æ‚åº¦ä¸º $\sqrt V$ï¼Œæ‰€ä»¥å¤æ‚åº¦æ»¡è¶³è¦æ±‚ã€‚

æ³¨æ„å½“åˆ†æ•°å€¼å·²ç»ç­‰äº $1$ çš„æ—¶å€™å°±ä¸è¦æ”¾è¿› `vector` é‡Œé¢äº†ï¼Œä¸€ä¸ªæ˜¯å®ƒçš„å€¼ä¸ä¼šæ”¹å˜ï¼ˆä¸€ç›´éƒ½æ˜¯ $1$ï¼‰ï¼Œä¸€ä¸ªæ˜¯è®¡ç®—éœ€è¦é™¤ä»¥å®ƒ $-1$ çš„å€¼ï¼Œç›´æ¥å¯¼è‡´ REã€‚

```cpp
#include <fstream>
#include <vector>
#include <queue>

using namespace std;
using LL = long long;

const LL kMaxN = 3e5 + 5;

ifstream cin("france.in");
ofstream cout("france.out");

LL a1[kMaxN], b1[kMaxN], a2[kMaxN], b2[kMaxN], f[kMaxN], n, m, v, sum;
vector<int> vct[kMaxN];
priority_queue<pair<LL, LL>, vector<pair<LL, LL>>, greater<>> q;

LL ceil(LL a, LL b) {
  return (a + b - 1) / b;
}

int main() {
  cin.tie(0)->sync_with_stdio(0);
  cin >> n >> m >> v;
  for (LL i = 1; i <= n; i++) {
    cin >> a1[i] >> b1[i];
  }
  for (LL i = 1; i <= m; i++) {
    cin >> a2[i] >> b2[i];
  }
  for (LL i = 1, j = 1, k = 1; i <= m; i++) {
    for (; k <= a2[i]; k++) {
      for (int j : vct[k]) {
        sum -= f[j];
        LL x = ceil(b1[j], a2[i]);
        sum += x * a1[j];
        f[j] = x * a1[j];
        if (x > 1) {
          vct[ceil(b1[j], x - 1)].push_back(j);
        }
      }
      vct[k].clear();
      vct[k].shrink_to_fit();  // æ¸…å†…å­˜
    }
    for (; j <= n && sum < b2[i]; j++) {
      LL x = ceil(b1[j], a2[i]);
      sum += x * a1[j];
      f[j] = x * a1[j];
      if (x > 1) {
        vct[ceil(b1[j], x - 1)].push_back(j);  // å¤§äºå®ƒ æ•´é™¤å€¼å°±ä¼šæ”¹å˜
      }
    }
    cout << (sum >= b2[i] ? j - 1 : -1) << '\n';
  }
  return 0;
}
```

## é…’æ¯

#ç»„åˆæ•°å­¦ #æ¦‚ç‡ä¸æœŸæœ› 

èµ›æ—¶æˆ‘ä¸¤ç§æš´åŠ›éƒ½ WA äº†ï¼Œéƒ½æ²¡æœ‰è°ƒå‡ºæ¥ï¼Œå¤ªæ‚²æƒ¨äº†ã€‚

é¦–å…ˆæ˜¯å¯¹äº $n,m\le 500$ï¼Œè€ƒè™‘ $nm^2$ çš„ DPã€‚è®¾ $dp_{i,j}$ è¡¨ç¤ºå‰ $i$ å±‚å·²ç»æœ‰äº† $j$ ä¸ª ACï¼Œé‚£ä¹ˆæšä¸¾ä¸‹ä¸€å±‚æœ‰äº† $k$ ä¸ª AC è®¡ç®—æ¦‚ç‡è½¬ç§»å³å¯ã€‚æ³¨æ„ç­”æ¡ˆéœ€è¦é¢å¤–ä¹˜ä¸Š $m!$ å› ä¸º $m$ ä¸ª AC ä½ç½®å¯ä»¥äº’æ¢ã€‚

å¯¹äº $n\le 20$ ä½† $m$ ç‰¹åˆ«å¤§çš„æ•°æ®ï¼Œè€ƒè™‘æšä¸¾æœ‰å“ªå‡ å±‚æ²¡æœ‰ä»»ä½•ä¸€ä¸ª ACï¼Œè®¡ç®—æ¦‚ç‡ååŠ èµ·æ¥ï¼Œå†ç”¨ $1$ å‡å»ä»–ä»¬ï¼Œå¾—åˆ°ä»»æ„ä¸€å±‚éƒ½æœ‰ AC çš„æ¦‚ç‡ã€‚